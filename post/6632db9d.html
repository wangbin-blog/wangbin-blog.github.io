<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>【Linux】Doris 安装部署 | 小王的博客</title><meta name="keywords" content="Linux"><meta name="author" content="Think.Wang"><meta name="copyright" content="Think.Wang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="【Linux】Doris 安装部署"><meta name="application-name" content="【Linux】Doris 安装部署"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="【Linux】Doris 安装部署"><meta property="og:url" content="https://wangbin-blog.github.io/post/6632db9d.html"><meta property="og:site_name" content="小王的博客"><meta property="og:description" content="在Linux环境下Doris和StarRocks的安装部署流程。首先，文档涵盖了环境配置，包括服务器环境、Docker的安装与卸载步骤，重点描述了Doris的编译安装过程，以及StarRocks的部署准备、环境配置、服务启动等步骤，提供了如何通过MySQL客户端访问FE、添加BE与Broker实例到"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://raw.gitmirror.com/wangbin-blog/pic-resources/main/2024/10/avatar.jpg"><meta property="article:author" content="Think.Wang"><meta property="article:tag" content="技术,编程,前端,后端,开源软件"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://raw.gitmirror.com/wangbin-blog/pic-resources/main/2024/10/avatar.jpg"><meta name="description" content="在Linux环境下Doris和StarRocks的安装部署流程。首先，文档涵盖了环境配置，包括服务器环境、Docker的安装与卸载步骤，重点描述了Doris的编译安装过程，以及StarRocks的部署准备、环境配置、服务启动等步骤，提供了如何通过MySQL客户端访问FE、添加BE与Broker实例到"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://wangbin-blog.github.io/post/6632db9d.html"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//www.clarity.ms"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/./css/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/./css/fancybox.css" media="print" onload="this.media='all'"><script>(function(c,l,a,r,i,t,y){
    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
})(window, document, "clarity", "script", "riq0f27slc");</script><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: {"enable":true,"ck":"3MC6lbtShUKo1XKa","LingQueMonitorID":"3MC6qBMrQzkobfzb"},
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: 'https://lucent-taiyaki-b3a4e7.netlify.app/.netlify/functions/twikoo',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🔍 分享与热心帮助","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"已经","messageNext":"天没有更新了，这篇文章可能已经过时了。"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    simplehomepage: false,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Think.Wang","link":"链接: ","source":"来源: 小王的博客","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '小王的博客',
  title: '【Linux】Doris 安装部署',
  postAI: '',
  pageFillDescription: 'doris 安装部署, 一、环境配置, 1. 服务器环境, 二、安装docker, 1. 使用xftp 等工具上传docker 安装包到linux服务器, 2. 解压, 3. 复制压缩后的文件到指定文件夹, 4. 注册编辑docker服务, 5. 添加可执行权限, 6. 一键三连, 7. docker卸载, 三、安装Doris, 1、编译, 1). 使用【doris】源码需要编译这里直接使用物理机编译, 2)、使用【starrocks】无需编译直接部署即可但CPU需支持【avx2】指令集, 2、部署环境准备, 3、安装部署, 1. 下载二进制包, 2. 解压, 3. 分发部署文件, 4. 部署fe, 5. 部署BE实例, 6. 部署Broker, 4、简单使用, 1. 修改root账户密码, 2. 建库建表安装部署一环境配置服务器环境下载地址下载地址官方文档官方文档学习地址二安装使用等工具上传安装包到服务器解压复制压缩后的文件到指定文件夹注册编辑服务如果无法使用可以在上编辑好文件后上传至服务器的此目录内参考添加可执行权限一键三连启动服务设置开机自启动卸载停掉服务查看安装的文件包删除所有安装的文件包查看包是否还有删除镜像放置的位置三安装编译使用源码需要编译这里直接使用物理机编译版本之前版本依赖如下如果使用及以上系统可以执行以下命令来安装依赖如果是可以执行以下命令在之后版本依赖如下如果使用及以上系统可以执行以下命令来安装依赖如果是可以执行以下命令安装完成后自行设置环境变量等可以通过命令找到的安装目录注意的版本仍然使用的依赖编译之后的代码将使用的依赖下载源码官网地址编译上传源码到服务器后解压文件进入文件夹后执行编译支持则使用下面命令进行编译如不支持需要加编译完成后产出文件在目录中使用无需编译直接部署即可但需支持指令集下载官方镜像文档部署环境准备操作系统版本需求系统版本及以上及以上软件需求软件版本及以上操作系统安装要求在末尾加入配置表示所有用户所有组软限制和硬限制对文件打开数设为修改后需要断开远程工具如等后重新连接方可生效或者直接再临时修改一次使用确认生效检查使用编译的可以跳过此检查使用下载部署的需要检查是否支持指令集有结果输出即表明支持如果无输出则需要更换支持的机器部分情况下我们会在系统下使用虚拟机安装作为测试环境此时我们可以使用等工具在下检查宿主机的指令集支持情况操作系统检查要求系统为及以上版本下文演示使用内核版本建议在以上查看系统及内核信息时钟同步的元数据要求时间精度要小于所以所有集群所有机器要进行时钟同步避免因为时钟问题引发的元数据不一致导致服务出现异常网络需求各个实例直接通过网络进行通讯以下表格展示了所有需要的端口实例名端口名称默认端口通信方向说明上的端口用于接收来自的请求上的的端口上心跳服务端口用于接收来自的心跳上的端口用于之间通讯用户上的端口上的端口每个的配置需要保持一致用户上的端口上的之间通信用的端口上的用于接收请求注当部署多个实例时要保证的配置相同部署前请确保各个端口在应有方向上的访问权限若上述端口不与服务器中其他服务的端口冲突通常不建议修改以为例部署前若需修改端口可在配置文件中修改为需要使用的端口再次注意集群中的端口需要一致默认为配置防火墙开放端口防火墙开放集群实例默认端口命令查看开放的端口安装依赖环境或均可以使用下文演示使用的安装操作见文档安装安装采用协议进行通信用户可通过连接到集群选择版本时要求采用之后的版本因为之前不能支持长度超过个字符的用户名下文演示使用为方便集群部署和运维我们通常建议在集群服务器中选择一个节点安装当然我们也可以不安装通过外部的等图形化工具直接访问安装操作文档见安装安装部署严格来说并没有所谓的运行模式生产环境下更是不建议进行单实例部署这里将单机部署整理出来主要是考虑当用户测试环境受限于机器数量或仅希望验证功能那么也可以在一台机器上简易部署把跑起来以服务器为例在进行完部署环境的准备工作后我们开始进行单节点的部署单节点架构设计如下机器节点部署服务部署目录及数据目录设计如下后续的部署操作严格按照部署设计进行服务说明部署目录日志目录默认元数据目录部署目录日志目录默认数据目录部署目录下载二进制包的二进制部署包可在官网下载获取下载地址使用编译到文件中的文件这儿是用为例将下载好的部署包上传至目录下解压目录结构目录启动脚本关闭脚本配置文件依赖的包实例目录版本查看启动脚本关闭脚本配置文件元数据离线管理工具版本已合并入可执行文件小版本升级时替换即可页面文件实例目录版本查看启动脚本关闭脚本配置文件包小版本升级时替换即可依赖的包页面文件用户自定义函数目录重构中目前不建议使用框架头文件框架静态库文件分发部署文件重命名移动文件到目录下部署修改配置文件各服务配置文件的默认配置已经足以启动集群不建议初尝用户修改较多配置的配置文件在测试环境中我们通常只需要关注以下三点注意默认端口避免端口冲突正常情况下不需要修改绑定避免多网卡情况下服务无法自动匹配到正确的特别注意绑定时如果不清楚表示法可以直接填写完整的不支持别名例如配置为该地址可以使用的方式查询设置元数据目录默认目录为我们建议新建目录并修改配置文件根据部署设计创建元数据存储目录针对和修改配置文件带的为注释红色字体为新增配置修改此处修改此处配置环境变量配置环境变量根目录例如保存并启动后台运行补充关闭的脚本是命令使用语言编写使用命令查看进程若发现有进程即为启动成功如果进程状态异常可在日志目录中查看日志追踪原因的主要日志在中所有查询的审计日志在中由于是初次启动如果在操作过程中遇到比较耗时的问题可以清空的元数据目录再从头开始操作访问使用访问查询端口默认为自带用户默认密码为空确认状态若能够正常访问已说明状态正常查询命令为即说明节点状态正常校验启动是否成功检查是否启动成功命令下有没有进程进程启动后会先加载元数据根据的不同在志中会看到最终会看到志并且可以通过客户端连接到则表示启动成功也可以通过如下连接查看是否启动成功如果返回则表示启动成功其余情况则可能存在问题外环境访问查看是否可以访问界登录账号默认为密码为空注如果在中查看不到启动失败的信息也许在中可以看到添加实例进入集群我们先将添加与实例添加入集群这里需要说明一下启动服务和将服务添加入集群并没有严格的先后顺序但若先启动服务在实例未加入集群前的日志中会打印一些提示未加入集群的信息例如所以我们可以在全部部署完成后使用将集群中其他实例通过添加入集群然后再逐个部署启动添加进入集群端口使用的默认为若添加实例进入集群时信息输入有误或出现其他异常我们可以将其删除后重新添加删除示例从集群中删除当前仅有一个实例故删除时可以直接使用命令删除删除为高风险操作所以这里的删除命令设计为了添加进入集群时需要给设定名称比如命名为端口使用的默认为从集群中删除暂时退出部署实例修改配置文件的配置文件在测试环境通常也是关注如下三点注意默认端口避免端口冲突正常情况下不需要修改绑定避免多网卡情况下无法自动找到正确的同样不清楚就可以直接填写完整的设置数据存储目录默认目录为我们建议新建目录并修改配置文件新建数据存储目录针对和修改配置文件带的为注释红色字体为新增配置修改此处修改此处启动补充关闭脚本为命令使用编写使用命令查看进程若发现有进程即为启动成功如果进程状态异常可在日志目录中查看日志追踪原因的主要日志在中其他的日志在中查看状态一般为即为状态正常若为可根据日志排查问题同样的因为当前为初次启动如果出现无法快速定位的问题可以清空数据目录重新启动服务部署在部署完与后主要服务已经部署完成是与外部对象存储等外部数据对接的中转服务若不需要可以不部署本身是无状态的进程可以随意启停不影响集群修改配置文件的配置文件通常不需要修改与实例和实例不同当前没有也不需要这个选项的服务默认绑定在上我们只需在前面节时输入正确可访问的即可启动补充关闭脚本为命令查看进程若发现有即为启动成功日志在中如果进程状态异常可查看日志追踪原因查看状态为即为状态正常如果状态异常可以根据日志定位问题简单使用修改账户密码例如修改密码也为建库建表的副本数是不能大于节点数的由于当前仅有一个节点我们建表时务必注意指定数据为单副本示例如下新建一个数据库',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-12-19 14:14:43',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://raw.gitmirror.com/wangbin-blog/pic-resources/main/2024/10/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="/./css/progress_bar.css"/><script async="async" src="/./js/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://wangbin-blog.github.io/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.gitmirror.com/wangbin-blog/pic-resources/main/2024/10/avatar.jpg" alt="博客"/><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" href="https://wangbin-blog.github.io/nav/" title="导航"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.gitmirror.com/wangbin-blog/pic-resources/main/2024/10/avatar.jpg" alt="导航"/><span class="back-menu-item-text">导航</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://docs.anheyu.com/" title="安知鱼主题"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼主题"/><span class="back-menu-item-text">安知鱼主题</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">小王的博客</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AI/" style="font-size: 1.05rem;">AI<sup>28</sup></a><a href="/tags/DotNet/" style="font-size: 1.05rem;">DotNet<sup>5</sup></a><a href="/tags/Hexo/" style="font-size: 1.05rem;">Hexo<sup>5</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>13</sup></a><a href="/tags/MACCMS/" style="font-size: 1.05rem;">MACCMS<sup>2</sup></a><a href="/tags/docker/" style="font-size: 1.05rem;">docker<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 1.05rem;">前端<sup>5</sup></a><a href="/tags/%E5%A8%B1%E4%B9%90/" style="font-size: 1.05rem;">娱乐<sup>5</sup></a><a href="/tags/%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/" style="font-size: 1.05rem;">实用工具<sup>1</sup></a><a href="/tags/%E5%B0%8F%E8%AF%B4/" style="font-size: 1.05rem;">小说<sup>2</sup></a><a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 1.05rem;">工具<sup>43</sup></a><a href="/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/" style="font-size: 1.05rem;">开发工具<sup>4</sup></a><a href="/tags/%E5%BD%B1%E8%A7%86/" style="font-size: 1.05rem;">影视<sup>2</sup></a><a href="/tags/%E6%BC%AB%E7%94%BB/" style="font-size: 1.05rem;">漫画<sup>2</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E7%BE%8E%E5%8C%96/" style="font-size: 1.05rem;">系统美化<sup>1</sup></a><a href="/tags/%E9%9F%B3%E4%B9%90/" style="font-size: 1.05rem;">音乐<sup>2</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">五月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">34</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">十月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">7</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">九月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">八月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">15</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux/" itemprop="url">Linux</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Linux/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Linux</span></a></span></div></div><h1 class="post-title" itemprop="name headline">【Linux】Doris 安装部署</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-05-21T00:31:13.000Z" title="发表于 2024-05-21 08:31:13">2024-05-21</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-12-19T06:14:43.425Z" title="更新于 2024-12-19 14:14:43">2024-12-19</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">5.2k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>22分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="【Linux】Doris 安装部署"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为北京"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>北京</span></div></div></div><article class="post-content" id="article-container" itemscope itemtype="https://wangbin-blog.github.io/post/6632db9d.html"><header><a class="post-meta-categories" href="/categories/Linux/" itemprop="url">Linux</a><a href="/tags/Linux/" tabindex="-1" itemprop="url">Linux</a><h1 id="CrawlerTitle" itemprop="name headline">【Linux】Doris 安装部署</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Think.Wang</span><time itemprop="dateCreated datePublished" datetime="2024-05-21T00:31:13.000Z" title="发表于 2024-05-21 08:31:13">2024-05-21</time><time itemprop="dateCreated datePublished" datetime="2024-12-19T06:14:43.425Z" title="更新于 2024-12-19 14:14:43">2024-12-19</time></header><h2 id="doris-安装部署"><a href="#doris-安装部署" class="headerlink" title="doris 安装部署"></a><strong>doris 安装部署</strong></h2><h3 id="一、环境配置"><a href="#一、环境配置" class="headerlink" title="一、环境配置"></a>一、环境配置</h3><h4 id="1-服务器环境"><a href="#1-服务器环境" class="headerlink" title="1. 服务器环境"></a>1. 服务器环境</h4><blockquote>
<ul>
<li>centos 7</li>
<li>docker <a target="_blank" rel="noopener" href="https://download.docker.com/linux/static/stable/x86_64/">下载地址</a></li>
<li>doris 1.0.0 <a target="_blank" rel="noopener" href="https://doris.apache.org/zh-CN/downloads/downloads.html#doris-%E4%B8%BB%E4%BB%A3%E7%A0%81">下载地址</a></li>
<li>doris <a target="_blank" rel="noopener" href="https://doris.apache.org/zh-CN/installing/compilation.html">官方文档</a></li>
<li>storrocks <a target="_blank" rel="noopener" href="https://docs.starrocks.com/zh-cn/main/quick_start/Deploy">官方文档</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/ult_me?type=blog">学习地址</a></li>
</ul>
</blockquote>
<span id="more"></span>
<h3 id="二、安装docker"><a href="#二、安装docker" class="headerlink" title="二、安装docker"></a>二、安装docker</h3><h4 id="1-使用xftp-等工具上传docker-安装包到linux服务器"><a href="#1-使用xftp-等工具上传docker-安装包到linux服务器" class="headerlink" title="1. 使用xftp 等工具上传docker 安装包到linux服务器"></a>1. 使用xftp 等工具上传docker 安装包到linux服务器</h4><h4 id="2-解压"><a href="#2-解压" class="headerlink" title="2. 解压"></a>2. 解压</h4><pre><code>tar -zxvf docekr-xxx.tgz  
</code></pre>
<h4 id="3-复制压缩后的文件到指定文件夹"><a href="#3-复制压缩后的文件到指定文件夹" class="headerlink" title="3. 复制压缩后的文件到指定文件夹"></a>3. 复制压缩后的文件到指定文件夹</h4><pre><code>cp docker/* /usr/bin
</code></pre>
<h4 id="4-注册编辑docker服务"><a href="#4-注册编辑docker服务" class="headerlink" title="4. 注册编辑docker服务"></a>4. 注册编辑docker服务</h4><blockquote>
<p><code>vim /etc/systemd/system/docker.service</code></p>
<p>如果无法使用vim 可以在windows上编辑好文件后上传至linux服务器的此目录内</p>
</blockquote>
<blockquote>
<p>参考docker.service:</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Docker Application Container Engine</span><br><span class="line">Documentation=https://docs.docker.com</span><br><span class="line">After=network-online.target firewalld.service</span><br><span class="line">Wants=network-online.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">LimitNOFILE=1048576</span><br><span class="line">LimitNPROC=1048576</span><br><span class="line">LimitCORE=infinity</span><br><span class="line">Type=notify</span><br><span class="line"># the default is not to use systemd for cgroups because the delegate issues still</span><br><span class="line"># exists and systemd currently does not support the cgroup feature set required</span><br><span class="line"># for containers run by docker</span><br><span class="line">#ExecStart=/usr/bin/dockerd --privileged=true --default-ulimit nofile=65536:65536 -H fd:// </span><br><span class="line">ExecStart=/usr/bin/dockerd</span><br><span class="line"></span><br><span class="line">ExecReload=/bin/kill -s HUP $MAINPID</span><br><span class="line"># Having non-zero Limit*s causes performance problems due to accounting overhead</span><br><span class="line"># in the kernel. We recommend using cgroups to do container-local accounting.</span><br><span class="line"># Uncomment TasksMax if your systemd version supports it.</span><br><span class="line"># Only systemd 226 and above support this version.</span><br><span class="line">#TasksMax=infinity</span><br><span class="line">TimeoutStartSec=0</span><br><span class="line"># set delegate yes so that systemd does not reset the cgroups of docker containers</span><br><span class="line">Delegate=yes</span><br><span class="line"># kill only the docker process, not all processes in the cgroup</span><br><span class="line">KillMode=process</span><br><span class="line"># restart the docker process if it exits prematurely</span><br><span class="line">Restart=on-failure</span><br><span class="line">StartLimitBurst=3</span><br><span class="line">StartLimitInterval=60s</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="5-添加可执行权限"><a href="#5-添加可执行权限" class="headerlink" title="5. 添加可执行权限"></a>5. 添加可执行权限</h4><pre><code>chmod +x /etc/systemd/system/docker.service
</code></pre>
<h4 id="6-一键三连"><a href="#6-一键三连" class="headerlink" title="6. 一键三连"></a>6. 一键三连</h4><pre><code> systemctl daemon-reload # 
 systemctl start docker # 启动服务
 systemctl enable docker.service # 设置开机自启动
</code></pre>
<h4 id="7-docker卸载"><a href="#7-docker卸载" class="headerlink" title="7. docker卸载"></a>7. docker卸载</h4><ol>
<li>停掉docker服务</li>
</ol>
<!---->

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop docker </span><br></pre></td></tr></table></figure>

<ol>
<li>查看yum安装的docker文件包</li>
</ol>
<!---->

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum list installed |grep docker</span><br></pre></td></tr></table></figure>

<ol>
<li>删除所有安装的docker文件包</li>
</ol>
<!---->

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y remove docker.x86_64</span><br></pre></td></tr></table></figure>

<ol>
<li>查看rpm包是否还有</li>
</ol>
<!---->

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa |grep docker</span><br></pre></td></tr></table></figure>

<ol>
<li>删除docker镜像放置的位置</li>
</ol>
<!---->

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf /var/lib/docker</span><br></pre></td></tr></table></figure>

<h3 id="三、安装Doris"><a href="#三、安装Doris" class="headerlink" title="三、安装Doris"></a>三、安装Doris</h3><h4 id="1、编译"><a href="#1、编译" class="headerlink" title="1、编译"></a>1、编译</h4><h5 id="1-使用【doris】源码，需要编译，这里直接使用物理机编译"><a href="#1-使用【doris】源码，需要编译，这里直接使用物理机编译" class="headerlink" title="1). 使用【doris】源码，需要编译，这里直接使用物理机编译"></a>1). 使用【doris】源码，需要编译，这里直接使用物理机编译</h5><ul>
<li><p>a).  0.14.0版本之前版本依赖如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GCC 7.3+, Oracle JDK 1.8+, Python 2.7+, Apache Maven 3.5+, CMake 3.11+ Bison 3.0+</span><br></pre></td></tr></table></figure>

<p>如果使用Ubuntu 16.04 及以上系统 可以执行以下命令来安装依赖</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get install build-essential openjdk-8-jdk maven cmake byacc flex automake libtool-bin bison binutils-dev libiberty-dev zip unzip libncurses5-dev curl git ninja-build python autopoint pkg-config</span><br></pre></td></tr></table></figure>

<p>如果是CentOS 可以执行以下命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> yum groupinstall <span class="string">&#x27;Development Tools&#x27;</span> &amp;&amp; <span class="built_in">sudo</span> yum install maven cmake byacc flex automake libtool bison binutils-devel zip unzip ncurses-devel curl git wget python2 glibc-static libstdc++-static java-1.8.0-openjdk</span><br></pre></td></tr></table></figure></li>
<li><p>b). 在0.14.0 之后版本依赖如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GCC 10+, Oracle JDK 1.8+, Python 2.7+, Apache Maven 3.5+, CMake 3.19.2+ Bison 3.0+</span><br></pre></td></tr></table></figure>

<p>如果使用Ubuntu 16.04 及以上系统 可以执行以下命令来安装依赖</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install build-essential openjdk-8-jdk maven cmake byacc flex automake libtool-bin bison binutils-dev libiberty-dev zip unzip libncurses5-dev curl git ninja-build python</span><br><span class="line"><span class="built_in">sudo</span> add-apt-repository ppa:ubuntu-toolchain-r/ppa</span><br><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt install gcc-10 g++-10 </span><br><span class="line"><span class="built_in">sudo</span> apt-get install autoconf automake libtool autopoint</span><br></pre></td></tr></table></figure>

<p>如果是CentOS 可以执行以下命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> yum groupinstall <span class="string">&#x27;Development Tools&#x27;</span> &amp;&amp; <span class="built_in">sudo</span> yum install maven cmake byacc flex automake libtool bison binutils-devel zip unzip ncurses-devel curl git wget python2 glibc-static libstdc++-static java-1.8.0-openjdk</span><br><span class="line"><span class="built_in">sudo</span> yum install centos-release-scl</span><br><span class="line"><span class="built_in">sudo</span> yum install devtoolset-10</span><br><span class="line">scl <span class="built_in">enable</span> devtoolset-10 bash</span><br></pre></td></tr></table></figure>

<p>**安装完成后，自行设置环境变量 PATH, JAVA_HOME 等。(可以通过alternatives –list命令找到jdk的安装目录) 注意： Doris 0.14.0 的版本仍然使用gcc7 的依赖编译，之后的代码将使用gcc10 的依赖 **</p>
</li>
<li><p>c). 下载源码</p>
<p><a target="_blank" rel="noopener" href="https://doris.apache.org/zh-CN/downloads/downloads.html">官网地址</a></p>
</li>
<li><p>d) 编译</p>
<p>上传源码到服务器后，解压文件，进入文件夹后，执行编译</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 支持则使用下面命令进行编译</span></span><br><span class="line">$ sh build.sh</span><br><span class="line"><span class="comment"># 如不支持需要加 USE_AVX2=0</span></span><br><span class="line">$ USE_AVX2=0 sh build.sh</span><br></pre></td></tr></table></figure>

<p><strong>编译完成后，产出文件在 output&#x2F; 目录中</strong></p>
</li>
</ul>
<h5 id="2-、使用【starrocks】无需编译，直接部署即可，但CPU需支持【avx2】指令集"><a href="#2-、使用【starrocks】无需编译，直接部署即可，但CPU需支持【avx2】指令集" class="headerlink" title="2)、使用【starrocks】无需编译，直接部署即可，但CPU需支持【avx2】指令集"></a>2)、使用【starrocks】无需编译，直接部署即可，但CPU需支持【avx2】指令集</h5><blockquote>
<ol>
<li>下载官方镜像 <a target="_blank" rel="noopener" href="https://docs.starrocks.com/zh-cn/main/administration/Build_in_docker">文档</a></li>
</ol>
</blockquote>
<h4 id="2、部署环境准备"><a href="#2、部署环境准备" class="headerlink" title="2、部署环境准备"></a>2、部署环境准备</h4><ul>
<li><p>Linux 操作系统版本需求</p>
<blockquote>
<table>
<thead>
<tr>
<th>Linux 系统</th>
<th>版本</th>
</tr>
</thead>
<tbody><tr>
<td>CentOS</td>
<td>7.1 及以上</td>
</tr>
<tr>
<td>Ubuntu</td>
<td>16.04 及以上</td>
</tr>
</tbody></table>
</blockquote>
</li>
<li><p>软件需求</p>
<blockquote>
<table>
<thead>
<tr>
<th>软件</th>
<th>版本</th>
</tr>
</thead>
<tbody><tr>
<td>java</td>
<td>1.8+</td>
</tr>
<tr>
<td>GCC</td>
<td>4.8.2 及以上</td>
</tr>
</tbody></table>
</blockquote>
</li>
<li><p>操作系统安装要求<br><code>vi /etc/security/limits.conf</code><br># 在末尾加入配置（表示：所有用户所有组，软限制和硬限制，对文件打开数，设为65535）：<br>* soft nofile 65536<br>    * hard nofile 65536<br># 修改后需要断开远程工具（如Xshell等）后重新连接方可生效，或者，直接再临时修改一次，使用：<br>​    ulimit -n 65535<br># 确认生效：<br>​    ulimit -n</p>
</li>
<li><p>CPU检查</p>
<blockquote>
<ul>
<li>使用doris 编译的 可以跳过此检查；</li>
<li>使用storrocks 下载部署的，需要检查cpu是否支持<code>avx2</code> 指令集</li>
</ul>
<!---->

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /proc/cpuinfo | grep avx2 </span><br></pre></td></tr></table></figure>

<p>有结果输出即表明CPU支持。如果无输出，则需要更换支持AVX2的机器。部分情况下，我们会在Windows系统下使用虚拟机安装CentOS作为测试环境，此时我们可以使用CPU-Z、AIDA64等工具在Windows下检查宿主机CPU的指令集支持情况。</p>
</blockquote>
</li>
<li><p>操作系统检查</p>
<blockquote>
<p>StarRocks要求系统为Linux CentOS 7及以上版本（下文演示使用CentOS 7.6），内核版本建议在3.10以上，查看系统及内核信息：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# <span class="built_in">cat</span> /etc/redhat-release</span><br><span class="line">CentOS Linux release 7.6.1810 (Core)</span><br><span class="line">[root@node01 ~]# <span class="built_in">uname</span> -a</span><br><span class="line">Linux node01 3.10.0-1160.25.1.el7.x86_64 <span class="comment">#1 SMP Wed Apr 28 21:49:45 UTC 2021 &gt; x86_64 x86_64 x86_64 GNU/Linux</span></span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>时钟同步</p>
<blockquote>
<p>Doris 的元数据要求时间精度要小于5000ms，所以所有集群所有机器要进行时钟同步，避免因为时钟问题引发的元数据不一致导致服务出现异常。</p>
</blockquote>
</li>
<li><p>网络需求</p>
<blockquote>
<p>Doris、storrocks 各个实例直接通过网络进行通讯。以下表格展示了所有需要的端口</p>
<table>
<thead>
<tr>
<th>实例名</th>
<th>端口名称</th>
<th>默认端口</th>
<th>通信方向</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>BE</td>
<td>be_port</td>
<td>9060</td>
<td>FE–&gt;BE</td>
<td>BE 上 thrift server 的端口，用于接收来自 FE 的请求</td>
</tr>
<tr>
<td>BE</td>
<td>webserver_port</td>
<td>8040</td>
<td>BE &lt;–&gt; BE</td>
<td>BE 上的 http server 的端口</td>
</tr>
<tr>
<td>BE</td>
<td>heartbeat_service_port</td>
<td>9050</td>
<td>FE –&gt; BE</td>
<td>BE 上心跳服务端口（thrift），用于接收来自 FE 的心跳</td>
</tr>
<tr>
<td>BE</td>
<td>brpc_port</td>
<td>8060</td>
<td>FE &lt;–&gt; BE, BE &lt;–&gt; BE</td>
<td>BE 上的 brpc 端口，用于 BE 之间通讯</td>
</tr>
<tr>
<td>FE</td>
<td>http_port</td>
<td>8030</td>
<td>FE &lt;–&gt; FE，用户 &lt;–&gt; FE</td>
<td>FE 上的 http server 端口</td>
</tr>
<tr>
<td>FE</td>
<td>rpc_port</td>
<td>9020</td>
<td>BE –&gt; FE, FE &lt;–&gt; FE</td>
<td>FE 上的 thrift server 端口，每个fe的配置需要保持一致</td>
</tr>
<tr>
<td>FE</td>
<td>query_port</td>
<td>9030</td>
<td>用户 &lt;–&gt; FE</td>
<td>FE 上的 mysql server 端口</td>
</tr>
<tr>
<td>FE</td>
<td>edit_log_port</td>
<td>9010</td>
<td>FE &lt;–&gt; FE</td>
<td>FE 上的 bdbje 之间通信用的端口</td>
</tr>
<tr>
<td>Broker</td>
<td>broker_ipc_port</td>
<td>8000</td>
<td>FE –&gt; Broker, BE –&gt; Broker</td>
<td>Broker 上的 thrift server，用于接收请求</td>
</tr>
</tbody></table>
</blockquote>
<blockquote>
<p><strong>注：</strong></p>
<ol>
<li><strong>当部署多个 FE 实例时，要保证 FE 的 http_port 配置相同。</strong></li>
<li><strong>部署前请确保各个端口在应有方向上的访问权限。</strong></li>
<li><strong>若上述端口不与服务器中其他服务的端口冲突，通常不建议修改。</strong></li>
<li>以FE为例，部署前若需修改端口，可在配置文件fe&#x2F;conf&#x2F;fe.conf中修改为需要使用的端口（再次注意集群中FE的http端口需要一致，默认为8030）：</li>
</ol>
<!---->

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># store metadata, create it if it is not exist.</span></span><br><span class="line"><span class="comment"># Default value is $&#123;STARROCKS_HOME&#125;/meta</span></span><br><span class="line"><span class="comment"># meta_dir = $&#123;STARROCKS_HOME&#125;/meta</span></span><br><span class="line">http_port = 8030</span><br><span class="line">rpc_port = 9020</span><br><span class="line">query_port = 9030</span><br><span class="line">edit_log_port = 9010</span><br><span class="line">mysql_service_nio_enabled = <span class="literal">true</span></span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>配置防火墙，开放端口</p>
<blockquote>
<p>防火墙开放集群实例默认端口命令：</p>
<pre><code>firewall-cmd --zone=public --add-port=8000/tcp --permanent
firewall-cmd --zone=public --add-port=8030/tcp --permanent
firewall-cmd --zone=public --add-port=8040/tcp --permanent
firewall-cmd --zone=public --add-port=8060/tcp --permanent
firewall-cmd --zone=public --add-port=9010/tcp --permanent
firewall-cmd --zone=public --add-port=9020/tcp --permanent
firewall-cmd --zone=public --add-port=9030/tcp --permanent
firewall-cmd --zone=public --add-port=9050/tcp --permanent
firewall-cmd --zone=public --add-port=9060/tcp --permanent
firewall-cmd --reload
</code></pre>
<blockquote>
<p>查看开放的端口：</p>
</blockquote>
<pre><code>[root@node01 ~]# firewall-cmd --list-port
8030/tcp 8000/tcp 8060/tcp 9010/tcp 9020/tcp 9030/tcp 9050/tcp 9060/tcp 8040/tcp
</code></pre>
</blockquote>
</li>
<li><p>安装JDK</p>
<blockquote>
<p>StarRocks依赖JDK 1.8+环境，Oracle JDK 1.8+或OpenJDK8+均可以使用（下文演示使用OpenJDK 1.8.0_41）：</p>
<p> [root@node01 ~]# java -version<br> openjdk version “1.8.0_41”<br> OpenJDK Runtime Environment (build 1.8.0_41-b04)<br> OpenJDK 64-Bit Server VM (build 25.40-b25, mixed mode)</p>
<p>OpenJDK 8的安装操作见:文档：<a target="_blank" rel="noopener" href="http://note.youdao.com/noteshare?id=6a91052faf8d92c8bb559d030af50173&sub=06660F2C04AC4D259E712C37184AF3BA">【Linux】安装OpenJDK.md</a></p>
</blockquote>
</li>
<li><p>安装Mysql</p>
<blockquote>
<p>StarRocks采用MySQL协议进行通信，用户可通过mysql-client连接到StarRocks集群。选 择mysql-client版本时要求采用5.1之后的版本，因为5.1之前不能支持长度超过16个字 符的用户名（下文演示使用mysql -client-5.7.35）。</p>
</blockquote>
<blockquote>
<p>为方便集群部署和运维，我们通常建议在集群服务器中选择一个节点安装mysql-client。当然，我们也可以不安装mysql-client，通过外部的SQLyog、DBeaver、Navicat等图形化工具直接访问StarRocks。</p>
</blockquote>
<blockquote>
<p>mysql 安装操作文档见：<a target="_blank" rel="noopener" href="http://note.youdao.com/noteshare?id=d5a1fbccd727cefea317f9cf16fe5fcd&sub=7CA727CB637D44AE8CE8C59C0101F31E">【Linux】CentOS7安装mysql5.7</a></p>
</blockquote>
</li>
</ul>
<h4 id="3、安装部署"><a href="#3、安装部署" class="headerlink" title="3、安装部署"></a>3、安装部署</h4><blockquote>
<p>严格来说，StarRocks并没有所谓的“Standalone运行模式”，生产环境下更是不建议进行单实例部署。这里将单机部署整理出来，主要是考虑当用户测试环境受限于机器数量或仅希望验证功能，那么也可以在一台机器上简易部署把StarRocks跑起来。</p>
</blockquote>
<blockquote>
<p>以服务器“starrocks（172.18.88.54）”为例，在进行完部署环境的准备工作后，我们开始进行单节点的部署。</p>
</blockquote>
<blockquote>
<p>单节点架构设计如下：</p>
</blockquote>
<table>
<thead>
<tr>
<th>机器节点</th>
<th>172.18.88.54（starrocks）</th>
</tr>
</thead>
<tbody><tr>
<td>部署服务</td>
<td>1 FE(Leader) </br>1 BE</br>1 Broker</br>mysql-client</td>
</tr>
</tbody></table>
<blockquote>
<p>部署目录及数据目录设计如下，后续的部署操作严格按照部署设计进行：</p>
</blockquote>
<table>
<thead>
<tr>
<th>服务</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>FE</td>
<td>部署目录：&#x2F;opt&#x2F;module&#x2F;starrocks&#x2F;fe </br> 日志目录：&#x2F;opt&#x2F;module&#x2F;starrocks&#x2F;fe&#x2F;log（默认）</br>元数据目录：&#x2F;opt&#x2F;meta</td>
</tr>
<tr>
<td>BE</td>
<td>部署目录：&#x2F;opt&#x2F;module&#x2F;starrocks&#x2F;be </br>日志目录：&#x2F;opt&#x2F;module&#x2F;starrocks&#x2F;be&#x2F;log（默认）</br>数据目录：&#x2F;opt&#x2F;storage</td>
</tr>
<tr>
<td>Broker</td>
<td>部署目录：&#x2F;opt&#x2F;module&#x2F;starrocks&#x2F;apache_hdfs_broker</td>
</tr>
</tbody></table>
<h5 id="1-下载二进制包"><a href="#1-下载二进制包" class="headerlink" title="1. 下载二进制包"></a>1. 下载二进制包</h5><p>StarRocks的二进制部署包可在官网下载获取：<a target="_blank" rel="noopener" href="https://www.starrocks.com/zh-CN/download/community">下载地址</a></p>
<p>doris 使用编译到output文件中的文件<br>这儿是用storrocks 为例,将下载好的部署包上传至 <code>/opt/software</code> 目录下</p>
<blockquote>
<pre><code>[root@starrocks ~]# mkdir /opt/software
[root@starrocks ~]# cd /opt/software/
[root@starrocks software]# ll
total 988752
-rw-r--r-- 1 root root 1012479814 Nov 22 15:46 StarRocks-1.19.2.tar.gz
</code></pre>
</blockquote>
<h5 id="2-解压-1"><a href="#2-解压-1" class="headerlink" title="2. 解压"></a>2. 解压</h5><blockquote>
<pre><code>[root@starrocks software]# tar xvf StarRocks-1.19.2.tar.gz
[root@starrocks software]# ll
total 988752
drwxrwxr-x 6 1007 1007        100 Nov 20 20:29 StarRocks-1.19.2
-rw-r--r-- 1 root root 1012479814 Nov 22 15:46 StarRocks-1.19.2.tar.gz
</code></pre>
</blockquote>
<p><strong>starrocks 目录结构：</strong></p>
<pre><code>StarRocks-1.19.2
├── apache_hdfs_broker  # Broker目录
│   ├── bin
│   │   ├── start_broker.sh  # Broker启动脚本
│   │   └── stop_broker.sh  # Broker关闭脚本
│   ├── conf
│   │   ├── apache_hdfs_broker.conf  # Broker配置文件
│   │   ├── hdfs-site.xml
│   │   └── log4j.properties
│   └── lib
│       └── *.jar  # Broker依赖的jar包
├── be  # BE实例目录
│   ├── bin
│   │   ├── common.sh
│   │   ├── show_be_version.sh  # BE版本查看
│   │   ├── start_be.sh  # BE启动脚本
│   │   └── stop_be.sh  # BE关闭脚本
│   ├── conf
│   │   ├── be.conf  # BE配置文件
│   │   └── hadoop_env.sh
│   ├── lib
│   │   ├── meta_tool  # Tablet元数据离线管理工具 [1.19版本已合并入starrocks_be]
│   │   └── starrocks_be  # BE可执行文件（小版本升级时替换即可）
│   └── www  # BE Web页面文件
├── fe  # FE实例目录
│   ├── bin
│   │   ├── common.sh
│   │   ├── show_fe_version.sh  # FE版本查看
│   │   ├── start_fe.sh  # FE启动脚本
│   │   └── stop_fe.sh  # FE关闭脚本
│   ├── conf
│   │   ├── fe.conf  # FE配置文件
│   │   └── hadoop_env.sh
│   ├── lib
│   │   ├── starrocks-fe.jar  # FE jar包（小版本升级时替换即可）
│   │   └── *.jar  # FE依赖的jar包
│   ├── log
│   │   └── *.log
│   └── webroot # FE Web页面文件
└── udf # 用户自定义函数目录 [重构中，目前不建议使用]
    ├── include
    │   ├── uda_test_harness.h
    │   └── udf.h  # UDF框架头文件
    └── lib
        └── libStarRocksUdf.a  # UDF框架静态库文件
</code></pre>
<h5 id="3-分发部署文件"><a href="#3-分发部署文件" class="headerlink" title="3. 分发部署文件"></a>3. 分发部署文件</h5><pre><code># 重命名
[root@starrocks software]# mv /opt/software/StarRocks-1.19.2 /opt/software/starrocks 
# 移动文件到module目录下
[root@starrocks software]# mv /opt/software/starrocks /opt/module/starrocks/
[root@starrocks software]# cd /opt/module/starrocks/
[root@starrocks starrocks]# ll
total 0
drwxr-xr-x. 5 1021 1021 40 Nov 22 14:40 apache_hdfs_broker
drwxr-xr-x. 6 1021 1021 51 Nov 22 14:40 be
drwxr-xr-x. 8 1021 1021 83 Nov 22 14:52 fe
drwxr-xr-x. 4 1021 1021 32 Nov 22 14:40 udf
</code></pre>
<h5 id="4-部署fe"><a href="#4-部署fe" class="headerlink" title="4. 部署fe"></a>4. 部署fe</h5><ul>
<li><p>修改FE配置文件</p>
<p>StarRocks各服务配置文件的默认配置已经足以启动集群，不建议初尝用户修改较多配置。FE的配置文件在测试环境中我们通常只需要关注以下三点：</p>
<p>a、注意默认端口，避免端口冲突，正常情况下不需要修改；</p>
<p>b、绑定IP，避免多网卡情况下服务无法自动匹配到正确的IP。特别注意，绑定ip时，如果不清楚CIDR表示法，可以直接填写完整的ip（不支持别名），例如配置为priority_networks &#x3D; 172.18.88.54&#x2F;24;该地址可以使用 <code>ip addr show</code> 的方式查询</p>
<p>c、设置元数据目录，默认目录为fe&#x2F;meta，我们建议新建目录并修改配置文件。</p>
<p>根据部署设计，创建元数据存储目录：</p>
<pre><code>[root@starrocks starrocks]# mkdir /opt/meta
</code></pre>
<p>针对b和c修改配置文件（带#的为注释，红色字体为新增配置）：</p>
<pre><code>[root@starrocks starrocks]# vi /opt/module/starrocks/fe/conf/fe.conf

# store metadata, create it if it is not exist.

# Default value is $&#123;STARROCKS_HOME&#125;/meta

# meta_dir = $&#123;STARROCKS_HOME&#125;/meta

# 修改此处
meta_dir = /opt/meta

…………

# Choose one if there are more than one ip except loopback address.

# Note that there should at most one ip match this list.

# If no ip match this rule, will choose one randomly.

# use CIDR format, e.g. 10.10.10.0/24

# Default value is empty.

# priority_networks = 10.10.10.0/24;192.168.0.0/16

# 修改此处
priority_networks = 192.168.110.98
</code></pre>
</li>
<li><p>配置环境变量</p>
<pre><code># 配置环境变量
vim /etc/profile.d/doris.sh
export DORIS_HOME=Doris根目录 # 例如/opt/doris
export PATH=$PATH:$DORIS_HOME/fe/bin:$DORIS_HOME/be/bin
# 保存并source
source /etc/profile.d/doris.sh
</code></pre>
</li>
<li><p>启动FE</p>
<pre><code>[root@starrocks starrocks]# cd /opt/module/starrocks/fe/bin/
# --daemon 后台运行
[root@starrocks bin]# ./start_fe.sh --daemon
</code></pre>
<blockquote>
<p>补充：关闭FE的脚本是stop_fe.sh，命令：.&#x2F;stop_fe.sh</p>
</blockquote>
<p>FE使用Java语言编写，使用jps命令查看java进程，若发现有StarRocksFe进程，即为启动成功：</p>
<pre><code>[root@starrocks bin]# jps
5178 Jps
5164 StarRocksFe
</code></pre>
<p><strong>如果进程状态异常可在FE日志目录中查看日志追踪原因，FE的主要日志在fe.log中，所有查询的审计日志在fe.audit.log中。由于是初次启动，如果在操作过程中遇到比较耗时的问题，可以清空FE的元数据目录，再从头开始操作。</strong></p>
</li>
<li><p>访问FE</p>
<p>使用mysql-client访问FE，FE查询端口默认为9030，自带用户root，默认密码为空：</p>
<pre><code>[root@starrocks bin]# mysql -h172.18.88.54 -P9030 -uroot

Welcome to the MySQL monitor.  Commands end with ; or \g.

Your MySQL connection id is 1

Server version: 5.1.0

………………

mysql&gt;
</code></pre>
</li>
<li><p>确认FE状态</p>
<p>若mysql-client能够正常访问FE，已说明FE状态正常，查询命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">    mysql&gt;  show frontends\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">             Name: 172.18.88.54_9010_1651209869733</span><br><span class="line">               IP: 172.18.88.54</span><br><span class="line">      EditLogPort: 9010</span><br><span class="line">         HttpPort: 8030</span><br><span class="line">        QueryPort: 9030</span><br><span class="line">          RpcPort: 9020</span><br><span class="line">             Role: FOLLOWER</span><br><span class="line">         IsMaster: true</span><br><span class="line">        ClusterId: 1166088853</span><br><span class="line">             Join: true</span><br><span class="line">            Alive: true</span><br><span class="line">ReplayedJournalId: 803</span><br><span class="line">    LastHeartbeat: 2022-04-29 14:11:57</span><br><span class="line">         IsHelper: true</span><br><span class="line">           ErrMsg: </span><br><span class="line">          Version: 0.14.0-release-Unknown</span><br><span class="line">1 row in set (20.04 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>Alive为true即说明FE节点状态正常。</strong></p>
</li>
<li><p>校验FE启动是否成功</p>
<blockquote>
<ol>
<li>检查是否启动成功, JPS 命令下有没有 PaloFe 进程</li>
<li>FE 进程启动后，会⾸先加载元数据，根据 FE ⻆⾊的不同，在⽇志中会看到 transfer from UNKNOWN to MASTER&#x2F;FOLLOWER&#x2F;OBSERVER 。最终会看到 thrift server started ⽇志，并且可以通过 mysql 客户端连接到 FE，则 表示 FE 启动成功。</li>
<li>也可以通过如下连接查看是否启动成功： http:&#x2F;&#x2F;fe_host:fe_http_port&#x2F;api&#x2F;bootstrap 如果返回： {“status”:”OK”,”msg”:”Success”} 则表示启动成功，其余情况，则可能存在问题。</li>
<li>外⽹环境访问 http:&#x2F;&#x2F;fe_host:fe_http_port 查看是否可以访问WebUI界 ⾯，登录账号默认为root，密码为空</li>
</ol>
</blockquote>
<blockquote>
<p><strong>注：如果在 fe.log 中查看不到启动失败的信息，也许在 fe.out 中可以看到。</strong></p>
</blockquote>
</li>
<li><p>添加实例进入集群</p>
<p>我们先将添加BE与Broker实例添加入集群。这里需要说明一下，“启动服务”和“将服务添加入集群”并没有严格的先后顺序，但若先启动服务，在实例未加入集群前，BE的日志中会打印一些提示未加入集群的WARNING信息，例如：Fail to get master client from cache。所以我们可以在FE全部部署完成后，使用mysql-client将集群中其他实例通过SQL添加入集群，然后再逐个部署启动。</p>
<p>添加BE进入集群，端口使用BE的heartbeat_service_port（默认为9050）：</p>
<pre><code>mysql&gt; alter system add backend &#39;172.18.88.54:9050&#39;;

Query OK, 0 rows affected (0.10 sec)
</code></pre>
<p>若添加实例进入集群时信息输入有误或出现其他异常，我们可以将其删除后重新添加，删除示例：</p>
<p>从集群中删除BE（当前仅有一个BE实例，故删除时可以直接使用dropp命令删除。删除BE为高风险操作，所以这里的删除命令设计为了dropp）：</p>
<pre><code>mysql&gt; alter system dropp backend &#39;172.18.88.54:9050&#39;;

Query OK, 0 rows affected (0.09 sec)
</code></pre>
<p>添加Broker进入集群时需要给Broker设定名称，比如命名为hdfs_broker，端口使用Broker的broker_ipc_port（默认为8000）：</p>
<pre><code>mysql&gt; alter system add broker hdfs_broker &#39;172.18.88.54:8000&#39;;

Query OK, 0 rows affected (0.03 sec)
</code></pre>
<p>从集群中删除Broker：</p>
<pre><code>mysql&gt; alter system drop broker hdfs_broker &#39;172.18.88.54:8000&#39;;

Query OK, 0 rows affected (0.04 sec)
</code></pre>
</li>
<li><p>暂时退出StarRocks：<br>mysql&gt; exit<br><br>Bye</p>
</li>
</ul>
<h5 id="5-部署BE实例"><a href="#5-部署BE实例" class="headerlink" title="5. 部署BE实例"></a>5. 部署BE实例</h5><ul>
<li><p>修改BE配置文件</p>
<ul>
<li>BE的配置文件，在测试环境通常也是关注如下三点：</li>
</ul>
<blockquote>
<ol>
<li>注意默认端口，避免端口冲突，正常情况下不需要修改；</li>
<li>绑定IP，避免多网卡情况下无法自动找到正确的IP（同样，不清楚CIDR就可以直接填写完整的IP）；</li>
<li>设置数据存储目录，默认目录为be&#x2F;storage，我们建议新建目录并修改配置文件。</li>
</ol>
</blockquote>
<ul>
<li>新建BE数据存储目录：</li>
</ul>
<!---->

<pre><code>[root@starrocks bin]# mkdir /opt/storage
</code></pre>
<ul>
<li>针对b和c修改配置文件（带#的为注释，红色字体为新增配置）：</li>
</ul>
<!---->

<pre><code>[root@starrocks bin]# vi /opt/module/starrocks/be/conf/be.conf

# Choose one if there are more than one ip except loopback address.

# Note that there should at most one ip match this list.

# If no ip match this rule, will choose one randomly.

# use CIDR format, e.g. 10.10.10.0/24

# Default value is empty.

# priority_networks = 10.10.10.0/24;192.168.0.0/16
# 修改此处
priority_networks = 172.18.88.54/24

…………

# you also can specify the properties by setting &#39;&lt;property&gt;:&lt;value&gt;&#39;, seperate by &#39;,&#39;

# property &#39;medium&#39; has a higher priority than the extension of path

#

# Default value is $&#123;STARROCKS_HOME&#125;/storage, you should create it by hand.

# storage_root_path = $&#123;STARROCKS_HOME&#125;/storage
# 修改此处
storage_root_path = /opt/storage
</code></pre>
</li>
<li><p>启动BE</p>
<pre><code>[root@starrocks bin]# cd /opt/module/starrocks/be/bin/

[root@starrocks bin]# ./start_be.sh --daemon
</code></pre>
<p><strong>补充：关闭BE脚本为stop_be.sh，命令：.&#x2F;stop_be.sh</strong></p>
<blockquote>
<p>BE使用C++编写，使用ps命令查看进程，若发现有starrocks_be进程，即为启动成功：</p>
</blockquote>
<pre><code>[root@starrocks bin]# ps -ef | grep starrocks_be

root       6670      1  1 19:46 pts/0    00:00:00 /opt/module/starrocks/be/lib/starrocks_be
</code></pre>
<p><strong>如果进程状态异常可在BE日志目录中查看日志追踪原因，BE的主要日志在be.INFO中，其他的日志在be.out中。</strong></p>
</li>
<li><p>查看BE状态</p>
<pre><code>[root@starrocks bin]# mysql -h127.0.0.1 -P9030 -uroot
</code></pre>
<!---->

<pre><code>mysql&gt; show backends\G
*************************** 1. row ***************************
            BackendId: 11001
              Cluster: default_cluster
                   IP: 172.18.88.54
        HeartbeatPort: 9050
               BePort: 9060
             HttpPort: 8040
             BrpcPort: 8060
        LastStartTime: 2022-04-29 14:01:04
        LastHeartbeat: 2022-04-29 14:02:11
                Alive: true
 SystemDecommissioned: false
ClusterDecommissioned: false
            TabletNum: 0
     DataUsedCapacity: .000 
        AvailCapacity: 34.793 GB
        TotalCapacity: 49.976 GB
              UsedPct: 30.38 %
       MaxDiskUsedPct: 30.38 %
               ErrMsg: 
              Version: 0.14.0-release-Unknown
               Status: &#123;&quot;lastSuccessReportTabletsTime&quot;:&quot;2022-04-29 14:02:10&quot;&#125;
1 row in set (20.04 sec)
</code></pre>
<p><strong>一般Alive为true即为状态正常，若为false，可根据日志排查问题。同样的，因为当前BE为初次启动，如果出现无法快速定位的问题，可以清空storage数据目录，重新启动服务。</strong></p>
</li>
</ul>
<h5 id="6-部署Broker"><a href="#6-部署Broker" class="headerlink" title="6. 部署Broker"></a>6. 部署Broker</h5><p>在部署完FE与BE后，StarRocks主要服务已经部署完成。Broker是StarRocks与外部HDFS&#x2F;对象存储等外部数据对接的中转服务，若不需要可以不部署。Broker本身是无状态的进程，可以随意启停，不影响集群。</p>
<ul>
<li><p>修改Broker配置文件</p>
<blockquote>
<p>Broker的配置文件通常不需要修改。与FE实例和BE实例不同，Broker当前没有也不需要priority_networks这个选项。Broker的服务默认绑定在0.0.0.0上，我们只需在前面4.5节 ADD BROKER时，输入正确可访问的BROKER IP即可。</p>
</blockquote>
</li>
<li><p>启动Broker</p>
<pre><code>[root@starrocks bin]# cd /opt/module/starrocks/apache_hdfs_broker/bin/

[root@starrocks bin]# ./start_broker.sh --daemon
</code></pre>
<p><strong>补充：关闭Broker脚本为stop_broker.sh，命令：.&#x2F;stop_broker.sh</strong></p>
<blockquote>
<p>查看java进程，若发现有BrokerBootstrap即为启动成功：</p>
</blockquote>
<pre><code>[root@starrocks bin]# jps | grep BrokerBootstrap

7594 BrokerBootstrap
</code></pre>
<p>Broker日志在apache_hdfs_broker.log中，如果进程状态异常可查看日志追踪原因。</p>
</li>
<li><p>查看Broker状态</p>
<pre><code>[root@starrocks bin]# mysql -h127.0.0.1 -P9030 -uroot
</code></pre>
<!---->

<pre><code>mysql&gt; show broker\G

*************************** 1. row ***************************

          Name: hdfs_broker

            IP: 172.18.88.54

          Port: 8000

         Alive: true

 LastStartTime: 2021-11-25 20:19:56

LastUpdateTime: 2021-11-25 20:21:31

        ErrMsg:

1 row in set (0.01 sec)
</code></pre>
<p><em>Alive为true即为状态正常，如果状态异常可以根据日志定位问题。</em></p>
</li>
</ul>
<h4 id="4、简单使用"><a href="#4、简单使用" class="headerlink" title="4、简单使用"></a>4、简单使用</h4><h5 id="1-修改root账户密码"><a href="#1-修改root账户密码" class="headerlink" title="1. 修改root账户密码"></a>1. 修改root账户密码</h5><p>例如修改root密码也为root：</p>
<pre><code>mysql&gt; set password=password(&#39;root&#39;);
    
Query OK, 0 rows affected (0.02 sec)
</code></pre>
<h5 id="2-建库建表"><a href="#2-建库建表" class="headerlink" title="2. 建库建表"></a>2. 建库建表</h5><p>StarRocks的副本数是不能大于BE节点数的，由于当前仅有一个BE节点，我们建表时<strong>务必注意指定数据为单副本</strong>，示例如下：<br>新建一个starrocks数据库：</p>
<pre><code>mysql&gt; create database starrocks;

Query OK, 0 rows affected (0.01 sec)

mysql&gt; use starrocks;

Database changed
</code></pre>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.gitmirror.com/wangbin-blog/pic-resources/main/2024/10/avatar.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.gitmirror.com/wangbin-blog/pic-resources/main/2024/10/avatar.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">Think.Wang</div><div class="post-copyright__author_desc">一个上了年纪的猿人</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://wangbin-blog.github.io/post/6632db9d.html">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://wangbin-blog.github.io/post/6632db9d.html')">【Linux】Doris 安装部署</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://wangbin-blog.github.io/post/6632db9d.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://wangbin-blog.github.io" target="_blank">小王的博客</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Linux/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Linux<span class="tagsPageCount">13</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://raw.gitmirror.com/wangbin-blog/pic-resources/main/2024/10/avatar.jpg" data-sites="wechat,qq"></div><link rel="stylesheet" href="/./css/share.min.css" media="print" onload="this.media='all'"/><script src="/./js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/ec0b08ff.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Hexo主题安装</div></div></a></div><div class="next-post pull-right"><a href="/post/4a0c2abb.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">【Linux】安装OpenJDK</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/post/6508e70d.html" title="Linux系统Tomcat启动指定JDK版本"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-12-09</div><div class="title">Linux系统Tomcat启动指定JDK版本</div></div></a></div><div><a href="/post/26185413.html" title="【Linux】DotNet运行命令"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-07-01</div><div class="title">【Linux】DotNet运行命令</div></div></a></div><div><a href="/post/5711187a.html" title="【Linux】Libgdiplus安装"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-07-01</div><div class="title">【Linux】Libgdiplus安装</div></div></a></div><div><a href="/post/bf223232.html" title="【Linux】Linux环境下运行jar包的几种方式"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-05-21</div><div class="title">【Linux】Linux环境下运行jar包的几种方式</div></div></a></div><div><a href="/post/dfef5267.html" title="【Linux】Nacos 问题"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-16</div><div class="title">【Linux】Nacos 问题</div></div></a></div><div><a href="/post/7a6abf49.html" title="【Linux】Redis 离线安装"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-16</div><div class="title">【Linux】Redis 离线安装</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-switch"><span class="first-comment">Twikoo</span><span id="switch-btn"></span><span class="second-comment">Waline</span></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div><div><div id="waline-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.gitmirror.com/wangbin-blog/pic-resources/main/2024/10/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description">欢迎来到小王的博客，这是一个专注于技术分享和个人成长的平台。在这里，你可以找到关于编程、操作系统、前端开发等方面的实用文章和教程。无论是初学者还是有一定经验的技术人员，都能从中受益。让我们一起探索技术的世界，共同进步！</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">Think.Wang</h1><div class="author-info__desc">一个上了年纪的猿人</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/wangbin-blog" target="_blank" title="GitHub"><i class="fab fa-github faa-tada"></i></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#doris-%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2"><span class="toc-number">1.</span> <span class="toc-text">doris 安装部署</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">1.1.</span> <span class="toc-text">一、环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%8E%AF%E5%A2%83"><span class="toc-number">1.1.1.</span> <span class="toc-text">1. 服务器环境</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%AE%89%E8%A3%85docker"><span class="toc-number">1.2.</span> <span class="toc-text">二、安装docker</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%BD%BF%E7%94%A8xftp-%E7%AD%89%E5%B7%A5%E5%85%B7%E4%B8%8A%E4%BC%A0docker-%E5%AE%89%E8%A3%85%E5%8C%85%E5%88%B0linux%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.2.1.</span> <span class="toc-text">1. 使用xftp 等工具上传docker 安装包到linux服务器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%A7%A3%E5%8E%8B"><span class="toc-number">1.2.2.</span> <span class="toc-text">2. 解压</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%A4%8D%E5%88%B6%E5%8E%8B%E7%BC%A9%E5%90%8E%E7%9A%84%E6%96%87%E4%BB%B6%E5%88%B0%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">1.2.3.</span> <span class="toc-text">3. 复制压缩后的文件到指定文件夹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%B3%A8%E5%86%8C%E7%BC%96%E8%BE%91docker%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.2.4.</span> <span class="toc-text">4. 注册编辑docker服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%B7%BB%E5%8A%A0%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%9D%83%E9%99%90"><span class="toc-number">1.2.5.</span> <span class="toc-text">5. 添加可执行权限</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E4%B8%80%E9%94%AE%E4%B8%89%E8%BF%9E"><span class="toc-number">1.2.6.</span> <span class="toc-text">6. 一键三连</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-docker%E5%8D%B8%E8%BD%BD"><span class="toc-number">1.2.7.</span> <span class="toc-text">7. docker卸载</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%AE%89%E8%A3%85Doris"><span class="toc-number">1.3.</span> <span class="toc-text">三、安装Doris</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E7%BC%96%E8%AF%91"><span class="toc-number">1.3.1.</span> <span class="toc-text">1、编译</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E4%BD%BF%E7%94%A8%E3%80%90doris%E3%80%91%E6%BA%90%E7%A0%81%EF%BC%8C%E9%9C%80%E8%A6%81%E7%BC%96%E8%AF%91%EF%BC%8C%E8%BF%99%E9%87%8C%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8%E7%89%A9%E7%90%86%E6%9C%BA%E7%BC%96%E8%AF%91"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">1). 使用【doris】源码，需要编译，这里直接使用物理机编译</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E3%80%81%E4%BD%BF%E7%94%A8%E3%80%90starrocks%E3%80%91%E6%97%A0%E9%9C%80%E7%BC%96%E8%AF%91%EF%BC%8C%E7%9B%B4%E6%8E%A5%E9%83%A8%E7%BD%B2%E5%8D%B3%E5%8F%AF%EF%BC%8C%E4%BD%86CPU%E9%9C%80%E6%94%AF%E6%8C%81%E3%80%90avx2%E3%80%91%E6%8C%87%E4%BB%A4%E9%9B%86"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">2)、使用【starrocks】无需编译，直接部署即可，但CPU需支持【avx2】指令集</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E9%83%A8%E7%BD%B2%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">1.3.2.</span> <span class="toc-text">2、部署环境准备</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2"><span class="toc-number">1.3.3.</span> <span class="toc-text">3、安装部署</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E4%B8%8B%E8%BD%BD%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%8C%85"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">1. 下载二进制包</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E8%A7%A3%E5%8E%8B-1"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">2. 解压</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E5%88%86%E5%8F%91%E9%83%A8%E7%BD%B2%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">3. 分发部署文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E9%83%A8%E7%BD%B2fe"><span class="toc-number">1.3.3.4.</span> <span class="toc-text">4. 部署fe</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-%E9%83%A8%E7%BD%B2BE%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.3.3.5.</span> <span class="toc-text">5. 部署BE实例</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-%E9%83%A8%E7%BD%B2Broker"><span class="toc-number">1.3.3.6.</span> <span class="toc-text">6. 部署Broker</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8"><span class="toc-number">1.3.4.</span> <span class="toc-text">4、简单使用</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E4%BF%AE%E6%94%B9root%E8%B4%A6%E6%88%B7%E5%AF%86%E7%A0%81"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">1. 修改root账户密码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%BB%BA%E5%BA%93%E5%BB%BA%E8%A1%A8"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">2. 建库建表</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/3ee92cff.html" title="大模型的得力干将MCP(5) - 应用场景和发展方向，窥探先机，不容错过">大模型的得力干将MCP(5) - 应用场景和发展方向，窥探先机，不容错过</a><time datetime="2025-05-14T07:04:47.581Z" title="发表于 2025-05-14 15:04:47">2025-05-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/1cf38b83.html" title="大模型的得力干将MCP(4) - 开发客户端">大模型的得力干将MCP(4) - 开发客户端</a><time datetime="2025-05-14T07:02:11.820Z" title="发表于 2025-05-14 15:02:11">2025-05-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/6d128846.html" title="大模型的得力干将MCP(3) - SSE服务">大模型的得力干将MCP(3) - SSE服务</a><time datetime="2025-05-14T07:00:15.911Z" title="发表于 2025-05-14 15:00:15">2025-05-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/9a18e38c.html" title="大模型的得力干将MCP(2) - 开发服务">大模型的得力干将MCP(2) - 开发服务</a><time datetime="2025-05-14T06:56:39.006Z" title="发表于 2025-05-14 14:56:39">2025-05-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/abc6a1e7.html" title="大模型的得力干将MCP(1) - 基础入门">大模型的得力干将MCP(1) - 基础入门</a><time datetime="2025-05-14T06:51:05.228Z" title="发表于 2025-05-14 14:51:05">2025-05-14</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By Think.Wang</div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">74</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">16</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">12</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://wangbin-blog.github.io/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.gitmirror.com/wangbin-blog/pic-resources/main/2024/10/avatar.jpg" alt="博客"/><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" href="https://wangbin-blog.github.io/nav/" title="导航"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.gitmirror.com/wangbin-blog/pic-resources/main/2024/10/avatar.jpg" alt="导航"/><span class="back-menu-item-text">导航</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://docs.anheyu.com/" title="安知鱼主题"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼主题"/><span class="back-menu-item-text">安知鱼主题</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AI/" style="font-size: 0.88rem;">AI<sup>28</sup></a><a href="/tags/DotNet/" style="font-size: 0.88rem;">DotNet<sup>5</sup></a><a href="/tags/Hexo/" style="font-size: 0.88rem;">Hexo<sup>5</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>13</sup></a><a href="/tags/MACCMS/" style="font-size: 0.88rem;">MACCMS<sup>2</sup></a><a href="/tags/docker/" style="font-size: 0.88rem;">docker<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 0.88rem;">前端<sup>5</sup></a><a href="/tags/%E5%A8%B1%E4%B9%90/" style="font-size: 0.88rem;">娱乐<sup>5</sup></a><a href="/tags/%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/" style="font-size: 0.88rem;">实用工具<sup>1</sup></a><a href="/tags/%E5%B0%8F%E8%AF%B4/" style="font-size: 0.88rem;">小说<sup>2</sup></a><a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 0.88rem;">工具<sup>43</sup></a><a href="/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/" style="font-size: 0.88rem;">开发工具<sup>4</sup></a><a href="/tags/%E5%BD%B1%E8%A7%86/" style="font-size: 0.88rem;">影视<sup>2</sup></a><a href="/tags/%E6%BC%AB%E7%94%BB/" style="font-size: 0.88rem;">漫画<sup>2</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E7%BE%8E%E5%8C%96/" style="font-size: 0.88rem;">系统美化<sup>1</sup></a><a href="/tags/%E9%9F%B3%E4%B9%90/" style="font-size: 0.88rem;">音乐<sup>2</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="/./js/fancybox.umd.js"></script><script src="/./js/instantpage.js" type="module"></script><script src="/./js/lazyload.iife.min.js"></script><script src="/./js/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('/./js/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2024 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2024 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Think.Wang 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://lucent-taiyaki-b3a4e7.netlify.app/.netlify/functions/twikoo',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('/./js/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://lucent-taiyaki-b3a4e7.netlify.app/.netlify/functions/twikoo',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><script>(() => {
  let initFn = window.walineFn || null

  const initWaline = (Fn) => {
    const waline = Fn(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://blog-waline-m9oa0dc1f-wangbins-projects.vercel.app/',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: false,
      imageUploader: true,
    }, null))

    const destroyWaline = () => {
      waline.destroy()
    }

    anzhiyu.addGlobalFn('pjax', destroyWaline, 'destroyWaline')
  }

  const loadWaline = async () => {
    if (initFn) initWaline(initFn)
    else {
      await getCSS('/./css/waline.css')
      if (false) await getCSS('https://cdn.cbd.int/@waline/client@3.1.3/dist/waline-meta.css')
      const { init } = await import('/./js/waline.js')
      initFn = init || Waline.init
      initWaline(initFn)
      window.walineFn = initFn
    }
  }

  if ('Twikoo' === 'Waline' || !true) {
    if (true) anzhiyu.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://lucent-taiyaki-b3a4e7.netlify.app/.netlify/functions/twikoo',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('/./js/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "";
</script><script async data-pjax src="/./js/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="/./css/ali_iconfont_css.css"><link rel="stylesheet" href="/./css/APlayer.min.css" media="print" onload="this.media='all'"><script src="/./js/APlayer.min.js"></script><script src="/./js/Meting2.min.js"></script><script src="/./js/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="/./js/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>